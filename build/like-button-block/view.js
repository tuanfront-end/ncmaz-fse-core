import*as t from"@wordpress/interactivity";var e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};const o=(i={getContext:()=>t.getContext,store:()=>t.store},a={},e.d(a,i),a),{state:n}=(0,o.store)("ncmazfse-core/like-button",{state:{get isLiked(){const{contextIsLiked:t,postId:e}=(0,o.getContext)();return n.likeData?.[e]?n.likeData[e].isLiked:t},get likeCount(){const{contextLikeCount:t,postId:e}=(0,o.getContext)();return n.likeData?.[e]?n.likeData[e].likeCount:t},get isLoading(){const{postId:t}=(0,o.getContext)();return n.loadingList.includes(t)}},actions:{handleLike:()=>{const t=(0,o.getContext)(),{postId:e}=t;try{n.loadingList.push(e);const o=new FormData;o.append("action","handle_like"),o.append("_ajax_nonce",n.likeButtonNonce),o.append("post_id",e.toString()),o.append("user_id",n.userId.toString()),o.append("handle",n.isLiked?"remove":"add"),fetch(n.ajaxUrl,{method:"POST",body:o}).then((t=>t.json())).then((({data:o,success:i})=>{if(!i)throw new Error("Server error");const a=Boolean(o.is_liked);let r=0;a?r=t.contextLikeCount+1:t.contextLikeCount>0&&(r=t.contextLikeCount-1),t.contextLikeCount=r,t.contextIsLiked=a,n.likeData={...n.likeData,[e]:{likeCount:r,isLiked:a}}})).finally((()=>{n.loadingList=n.loadingList.filter((t=>t!==e))}))}catch(t){console.log("Error Server data!",t),n.loadingList=n.loadingList.filter((t=>t!==e))}}},callbacks:{logHandleLikeInit:()=>{}}});var i,a;