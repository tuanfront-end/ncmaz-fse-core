import*as t from"@wordpress/interactivity";var e={d:(t,a)=>{for(var o in a)e.o(a,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:a[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};const a=(n={getContext:()=>t.getContext,store:()=>t.store},s={},e.d(s,n),s),{state:o}=(0,a.store)("ncmfse/save-button-btn",{state:{get isSaved(){const{contextIsSaved:t,postId:e}=(0,a.getContext)();return o.saveData?.[e]?o.saveData[e].isSaved:t},get saveCount(){const{contextSaveCount:t,postId:e}=(0,a.getContext)();return o.saveData?.[e]?o.saveData[e].saveCount:t},get isLoading(){const{postId:t}=(0,a.getContext)();return o.loadingList.includes(t)}},actions:{handleSave:()=>{const t=(0,a.getContext)(),{postId:e}=t;try{o.loadingList.push(e);const a=new FormData;a.append("action","handle_save"),a.append("_ajax_nonce",o.saveButtonNonce),a.append("post_id",e.toString()),a.append("user_id",o.userId.toString()),a.append("handle",o.isSaved?"remove":"add"),fetch(o.ajaxUrl,{method:"POST",body:a}).then((t=>t.json())).then((({data:a,success:n})=>{if(!n)throw new Error("Server error");const s=Boolean(a.is_saved);let r=0;s?r=t.contextSaveCount+1:t.contextSaveCount>0&&(r=t.contextSaveCount-1),t.contextSaveCount=r,t.contextIsSaved=s,o.saveData={...o.saveData,[e]:{isSaved:s,saveCount:r}}})).finally((()=>{o.loadingList=o.loadingList.filter((t=>t!==e))}))}catch(t){console.log("Error Server data!",t),o.loadingList=o.loadingList.filter((t=>t!==e))}}},callbacks:{logHandleSaveInit:()=>{}}});var n,s;