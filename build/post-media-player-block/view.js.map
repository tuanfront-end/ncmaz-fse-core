{"version":3,"file":"post-media-player-block/view.js","mappings":"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","sources":["webpack://ncmaz-fse-core/external module \"@wordpress/interactivity\"","webpack://ncmaz-fse-core/webpack/bootstrap","webpack://ncmaz-fse-core/webpack/runtime/make namespace object","webpack://ncmaz-fse-core/./src/post-media-player-block/view.ts"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * WordPress dependencies\n */\nimport { store, getContext, getElement } from \"@wordpress/interactivity\";\n\ninterface TPost {\n\tid: number;\n\ttitle: string;\n\thref: string;\n\taudio: {\n\t\tsrc: string;\n\t};\n}\n\n// view.js\ninterface TContext {\n\tplayerRef: HTMLAudioElement | null;\n\tsliderRef: HTMLInputElement | null;\n}\n\ninterface TState {\n\tplaying: boolean;\n\tmuted: boolean;\n\tduration: number;\n\tcurrentTime: number;\n\tepisode: null | TPost;\n\tplaybackRate: number;\n\tisPlaybackRate1x: boolean;\n\tisPlaybackRate1_5x: boolean;\n\tisPlaybackRate2x: boolean;\n\t//\n\tplayedWidth: string;\n\tthumbLeft: string;\n\tcurrentTimeHuman: string;\n\tdurationHuman: string;\n}\n\nconst { state, actions } = store(\"ncmfse/post-media-player-block\", {\n\tstate: {\n\t\tget playedWidth() {\n\t\t\treturn `calc(${(state.currentTime / state.duration) * 100}% -  0.25rem)`;\n\t\t},\n\t\tget thumbLeft() {\n\t\t\treturn `calc(${(state.currentTime / state.duration) * 100}%)`;\n\t\t},\n\t\tget currentTimeHuman() {\n\t\t\treturn formatTime(\n\t\t\t\tparseTime(state.currentTime),\n\t\t\t\tparseTime(state.duration),\n\t\t\t);\n\t\t},\n\t\tget durationHuman() {\n\t\t\treturn formatTime(parseTime(state.duration));\n\t\t},\n\t\tget isPlaybackRate1x() {\n\t\t\treturn state.playbackRate === 1;\n\t\t},\n\t\tget isPlaybackRate1_5x() {\n\t\t\treturn state.playbackRate === 1.5;\n\t\t},\n\t\tget isPlaybackRate2x() {\n\t\t\treturn state.playbackRate === 2;\n\t\t},\n\t} as TState,\n\tactions: {\n\t\t// dispatchers\n\t\tdispatchPlay() {\n\t\t\tstate.playing = true;\n\t\t},\n\t\tdispatchPause() {\n\t\t\tstate.playing = false;\n\t\t},\n\t\tdispatchDurationChange() {\n\t\t\tconst context = getContext<TContext>();\n\t\t\tconst { playerRef } = context;\n\t\t\tstate.duration = Math.floor(playerRef?.duration || 0);\n\t\t},\n\t\tdispatchCurrentTimeChange() {\n\t\t\tconst context = getContext<TContext>();\n\t\t\tconst { playerRef } = context;\n\t\t\tstate.currentTime = Math.floor(playerRef?.currentTime || 0);\n\t\t},\n\n\t\t// actions\n\t\tplay() {\n\t\t\tconst context = getContext<TContext>();\n\t\t\tconst { playerRef } = context;\n\t\t\tconst { episode } = state;\n\t\t\tif (episode) {\n\t\t\t\tstate.playing = true;\n\n\t\t\t\tif (playerRef && playerRef.currentSrc !== episode.audio.src) {\n\t\t\t\t\tlet playbackRate = playerRef.playbackRate;\n\t\t\t\t\tplayerRef.src = episode.audio.src;\n\t\t\t\t\tplayerRef.load();\n\t\t\t\t\tplayerRef.pause();\n\t\t\t\t\tplayerRef.playbackRate = playbackRate;\n\t\t\t\t\tplayerRef.currentTime = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tplayerRef?.play();\n\t\t},\n\t\tpause() {\n\t\t\tconst context = getContext<TContext>();\n\t\t\tconst { playerRef } = context;\n\t\t\tplayerRef?.pause();\n\t\t},\n\t\ttoggle() {\n\t\t\tactions.isPlaying() ? actions.pause() : actions.play();\n\t\t},\n\t\ttoggleMute() {\n\t\t\tstate.muted = !state.muted;\n\t\t},\n\t\tisPlaying() {\n\t\t\tconst context = getContext<TContext>();\n\t\t\tconst { playerRef } = context;\n\t\t\tconst { episode } = state;\n\t\t\treturn episode\n\t\t\t\t? state.playing && playerRef?.currentSrc === episode.audio.src\n\t\t\t\t: state.playing;\n\t\t},\n\t\trewind10s() {\n\t\t\tconst context = getContext<TContext>();\n\t\t\tconst { playerRef } = context;\n\t\t\tif (!playerRef) return;\n\t\t\tplayerRef.currentTime += -10;\n\t\t},\n\t\tforward10s() {\n\t\t\tconst context = getContext<TContext>();\n\t\t\tconst { playerRef } = context;\n\t\t\tif (!playerRef) return;\n\t\t\tplayerRef.currentTime += 10;\n\t\t},\n\t\ttogglePlaybackRate() {\n\t\t\tconst context = getContext<TContext>();\n\t\t\tconst { playerRef } = context;\n\t\t\tif (!playerRef) return;\n\n\t\t\tif (state.playbackRate === 1) {\n\t\t\t\tstate.playbackRate = 1.5;\n\t\t\t} else if (state.playbackRate === 1.5) {\n\t\t\t\tstate.playbackRate = 2;\n\t\t\t} else {\n\t\t\t\tstate.playbackRate = 1;\n\t\t\t}\n\t\t\tplayerRef.playbackRate = state.playbackRate;\n\t\t},\n\n\t\t// Slider\n\t\thandleSeekMouseDown() {\n\t\t\tconst context = getContext<TContext>();\n\t\t\tconst { playerRef } = context;\n\t\t\tplayerRef?.pause();\n\t\t},\n\t\thandleSeekChange() {\n\t\t\tconst context = getContext<TContext>();\n\t\t\tconst { playerRef, sliderRef } = context;\n\t\t\tif (!playerRef?.currentSrc || !sliderRef) return;\n\t\t\tconst currentTime = playerRef.duration * parseFloat(sliderRef.value);\n\t\t\t// update the state current time\n\t\t\tstate.currentTime = Math.floor(currentTime);\n\t\t\t// Update the player's current time\n\t\t\tplayerRef.currentTime = Math.floor(currentTime);\n\t\t},\n\t\thandleSeekMouseUp() {\n\t\t\tconst context = getContext<TContext>();\n\t\t\tconst { playerRef } = context;\n\t\t\tplayerRef?.play();\n\t\t},\n\t},\n\tcallbacks: {\n\t\tonInit: () => {\n\t\t\tconst context = getContext<TContext>();\n\t\t\tconst { ref } = getElement();\n\n\t\t\tcontext.playerRef = ref?.querySelector(\n\t\t\t\t\"audio.post-media-player__audio\",\n\t\t\t) as HTMLAudioElement;\n\n\t\t\tcontext.sliderRef = ref?.querySelector(\n\t\t\t\t\"input.post-media-player__slider-input\",\n\t\t\t) as HTMLInputElement;\n\t\t},\n\t},\n});\n\nfunction parseTime(seconds: number) {\n\tlet hours = Math.floor(seconds / 3600);\n\tlet minutes = Math.floor((seconds - hours * 3600) / 60);\n\tseconds = seconds - hours * 3600 - minutes * 60;\n\treturn [hours, minutes, seconds];\n}\n\nfunction formatTime(seconds: Array<number>, totalSeconds = seconds) {\n\tlet totalWithoutLeadingZeroes = totalSeconds.slice(\n\t\ttotalSeconds.findIndex((x) => x !== 0),\n\t);\n\treturn seconds\n\t\t.slice(seconds.length - totalWithoutLeadingZeroes.length)\n\t\t.map((x) => x.toString().padStart(2, \"0\"))\n\t\t.join(\":\");\n}\n"],"names":["store","getContext","getElement","state","actions","playedWidth","currentTime","duration","thumbLeft","currentTimeHuman","formatTime","parseTime","durationHuman","isPlaybackRate1x","playbackRate","isPlaybackRate1_5x","isPlaybackRate2x","dispatchPlay","playing","dispatchPause","dispatchDurationChange","context","playerRef","Math","floor","dispatchCurrentTimeChange","play","episode","currentSrc","audio","src","load","pause","toggle","isPlaying","toggleMute","muted","rewind10s","forward10s","togglePlaybackRate","handleSeekMouseDown","handleSeekChange","sliderRef","parseFloat","value","handleSeekMouseUp","callbacks","onInit","ref","querySelector","seconds","hours","minutes","totalSeconds","totalWithoutLeadingZeroes","slice","findIndex","x","length","map","toString","padStart","join"],"sourceRoot":""}